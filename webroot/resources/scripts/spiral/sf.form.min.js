!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sf"));else if("function"==typeof define&&define.amd)define(["sf"],t);else{var o=t("object"==typeof exports?require("sf"):e.sf);for(var s in o)("object"==typeof exports?exports:e)[s]=o[s]}}(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return function(e){function t(s){if(o[s])return o[s].exports;var r=o[s]={exports:{},id:s,loaded:!1};return e[s].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=o(1),n=s(r),i=o(2),a=s(i);n["default"].registerInstanceType(a["default"],"js-sf-form"),e.exports=a["default"]},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var _assign=__webpack_require__(3),_assign2=_interopRequireDefault(_assign);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _sf=__webpack_require__(1),_sf2=_interopRequireDefault(_sf),formMessages=__webpack_require__(18),iterateInputs=__webpack_require__(23);__webpack_require__(24);var Form=function(e,t,o){this._construct(e,t,o)};Form.prototype=_sf2["default"].createModulePrototype(),Form.prototype.name="form",Form.prototype._construct=function(e,t,o){this.init(e,t,o),this.mixMessagesOptions(),this.DOMEvents=new this.sf.modules.helpers.DOMEvents,this.addEvents(),this.events=new this.sf.modules.core.Events(["beforeSend","success","error","always"]),e.iterateInputs=iterateInputs},Form.prototype.optionsToGrab={context:{processor:function(e,t){return e}},self:{processor:function(e,t){return this}},url:{domAttr:"action",value:"/"},method:{domAttr:"method",value:"POST"},lockType:{value:"default",domAttr:"data-lockType"},messagesType:{value:"spiral",domAttr:"data-messagesType"},messages:{value:"",domAttr:"data-messages",processor:function(e,t,o){if(!t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(s){console.error("Form JSON.parse error: ",s)}return(0,_assign2["default"])(o.value,t)}},useAjax:{value:!0,domAttr:"data-useAjax",processor:function(e,t){return"boolean"==typeof t?t:(t=void 0!==t&&null!==t?t.toLowerCase():"","false"===t?t=!1:"true"===t&&(t=!0),t)}},ajaxCallback:{value:!1,domAttr:"data-callback"},beforeSubmitCallback:{value:!1,domAttr:"data-before-submit"},afterSubmitCallback:{value:!1,domAttr:"data-after-submit"},headers:{value:{Accept:"application/json"},domAttr:"data-headers",processor:function(e,t,o){if(void 0===t||null==t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(s){console.error("Form JSON.parse error: ",s)}return(0,_assign2["default"])(o.value,t)}}},Form.prototype.mixMessagesOptions=function(){var e=this.sf.options.instances.form;this.options.messages=(0,_assign2["default"])({},formMessages.defaults,e&&e.messages&&e.messages[this.options.messagesType],this.options.messages)},Form.prototype.onSubmit=function(e){return this.sf.getInstance("lock",this.node)?(e.preventDefault(),void e.stopPropagation()):(this.removeMessages(),this.options.data=this.getFormData(),window.FormData||0===this.options.context.querySelectorAll("input[type='file']").length||(this.options.useAjax=!1),this.events.trigger("beforeSend",this.options),void(this.options.useAjax&&(this.send(this.options),e.preventDefault(),e.stopPropagation())))},Form.prototype.lock=function(e){this.options.lockType&&"none"!==this.options.lockType&&(e?this.sf.removeInstance("lock",this.node)||console.warn("You try to remove 'lock' instance, but it is not available or not started"):this.sf.addInstance("lock",this.node,{type:this.options.lockType})||console.warn("You try to add 'lock' instance, but it is not available or already started"))},Form.prototype.showFormMessage=formMessages.showFormMessage,Form.prototype.showFieldMessage=formMessages.showFieldMessage,Form.prototype.showFieldsMessages=formMessages.showFieldsMessages,Form.prototype.showMessages=formMessages.showMessages,Form.prototype.removeMessages=formMessages.removeMessages,Form.prototype.removeMessage=formMessages.removeMessage,Form.prototype.processAnswer=function(e){this.options.messagesType&&this.showMessages(e)},Form.prototype.send=function(sendOptions){var that=this;if(this.lock(),sendOptions.beforeSubmitCallback){var fn=eval(sendOptions.beforeSubmitCallback);"function"==typeof fn&&fn.call(sendOptions)}this.sf.ajax.send(sendOptions).then(function(e){return that.events.trigger("success",sendOptions),e},function(e){return that.events.trigger("error",sendOptions),e}).then(function(e){that.lock(!0),that.processAnswer(e),that.events.trigger("always",sendOptions)})},Form.prototype.getFormData=function(){return window.FormData?new FormData(this.options.context):(console.log("Form `"+this.options.context+"` were processed without FormData."),new formToObject(this.options.context))},Form.prototype.setOptions=function(e){this.options=(0,_assign2["default"])(this.options,e)},Form.prototype.addEvents=function(){var e=this;this.DOMEvents.add([{DOMNode:this.options.context,eventType:"submit",eventFunction:function(t){e.onSubmit.call(e,t)}}])},Form.prototype.die=function(){this.DOMEvents.removeAll()},exports["default"]=Form},function(e,t,o){e.exports={"default":o(4),__esModule:!0}},function(e,t,o){o(5),e.exports=o(8).Object.assign},function(e,t,o){var s=o(6);s(s.S+s.F,"Object",{assign:o(11)})},function(e,t,o){var s=o(7),r=o(8),n=o(9),i="prototype",a=function(e,t,o){var c,u,f,l=e&a.F,p=e&a.G,m=e&a.S,h=e&a.P,d=e&a.B,g=e&a.W,v=p?r:r[t]||(r[t]={}),y=p?s:m?s[t]:(s[t]||{})[i];p&&(o=t);for(c in o)u=!l&&y&&c in y,u&&c in v||(f=u?y[c]:o[c],v[c]=p&&"function"!=typeof y[c]?o[c]:d&&u?n(f,s):g&&y[c]==f?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[i]=e[i],t}(f):h&&"function"==typeof f?n(Function.call,f):f,h&&((v[i]||(v[i]={}))[c]=f))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,e.exports=a},function(e,t){var o=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},function(e,t){var o=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=o)},function(e,t,o){var s=o(10);e.exports=function(e,t,o){if(s(e),void 0===t)return e;switch(o){case 1:return function(o){return e.call(t,o)};case 2:return function(o,s){return e.call(t,o,s)};case 3:return function(o,s,r){return e.call(t,o,s,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,o){var s=o(12),r=o(13),n=o(15);e.exports=o(17)(function(){var e=Object.assign,t={},o={},s=Symbol(),r="abcdefghijklmnopqrst";return t[s]=7,r.split("").forEach(function(e){o[e]=e}),7!=e({},t)[s]||Object.keys(e({},o)).join("")!=r})?function(e,t){for(var o=r(e),i=arguments,a=i.length,c=1,u=s.getKeys,f=s.getSymbols,l=s.isEnum;a>c;)for(var p,m=n(i[c++]),h=f?u(m).concat(f(m)):u(m),d=h.length,g=0;d>g;)l.call(m,p=h[g++])&&(o[p]=m[p]);return o}:Object.assign},function(e,t){var o=Object;e.exports={create:o.create,getProto:o.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:o.getOwnPropertyDescriptor,setDesc:o.defineProperty,setDescs:o.defineProperties,getKeys:o.keys,getNames:o.getOwnPropertyNames,getSymbols:o.getOwnPropertySymbols,each:[].forEach}},function(e,t,o){var s=o(14);e.exports=function(e){return Object(s(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,o){var s=o(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==s(e)?e.split(""):Object(e)}},function(e,t){var o={}.toString;e.exports=function(e){return o.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){return"[object Object]"!==Object.prototype.toString.call(e)&&(e={text:e,type:t}),e.text=e.text||e.message||e,e.type=e.type||t,e}var n=o(19),i=s(n),a={template:'<div class="alert form-msg ${type}"><button class="btn-close">Ã—</button><p class="msg">${text}</p></div>',close:".btn-close",place:"bottom",levels:{success:"success",info:"info",warning:"warning",error:"error"},field:".item-form",fieldTemplate:'<div class="alert form-msg ${type}"><p class="msg">${text}</p></div>',fieldClose:".btn-close",fieldPlace:"bottom",fieldPrefix:""};a.levels.message=a.levels.success,a.levels.debug=a.levels.success,a.levels.info=a.levels.notice=a.levels.info,a.levels.danger=a.levels.critical=a.levels.alert=a.levels.emergency=a.levels.error,e.exports={defaults:a,showMessages:function(e){if(e){var t=!1,o=this;for(var s in this.options.messages.levels)e[s]&&(this.showFormMessage(e[s],this.options.messages.levels[s]),t=!0);if(e.messages&&(this.showFieldsMessages(e.messages,"success"),t=!0),e.errors&&(this.showFieldsMessages(e.errors,"error"),t=!0),e.warnings&&(this.showFieldsMessages(e.warnings,"warning"),t=!0),!t&&e.status>300){var r=e.status?e.status+" ":"";r+=e.statusText?e.statusText:"",r+=e.data&&!e.statusText?e.data:"",r+=0===r.length?e:"",this.showFormMessage(r,"error")}this._messages.forEach(function(e){e.close&&(e.closeHandler=o.removeMessage.bind(o,e),e.close.addEventListener("click",e.closeHandler))})}},removeMessage:function(e,t){e.close&&e.close.removeEventListener("click",e.closeHandler),e.el.parentNode.removeChild(e.el),e.field&&e.field.classList.remove(this.options.messages.fieldPrefix+e.type),t&&(t.preventDefault&&t.preventDefault(),this._messages.splice(this._messages.indexOf(e),1))},removeMessages:function(){var e=this;this._messages&&this._messages.forEach(function(t){e.removeMessage(t,!1)}),e._messages=[]},showFormMessage:function(e,t){e=r(e,t);var o,s,n=this.options.messages.template,i=new DOMParser;for(var a in e){if(!e.hasOwnProperty(a))return;n=n.replace("${"+a+"}",e[a])}o=i.parseFromString(n,"text/html").firstChild.lastChild.firstChild,"bottom"===this.options.messages.place?this.node.appendChild(o):"top"===this.options.messages.place?this.node.insertBefore(o,this.node.firstChild):(s=document.querySelector(this.options.messages.place),s.appendChild(o)),this._messages.push({el:o,close:o.querySelector(this.options.messages.close)})},showFieldMessage:function(e,t,o,s){var n,i=s?e:sf.helpers.domTools.closest(e,this.options.messages.field),a=this.options.messages.fieldTemplate;if(i){var c=new DOMParser;t=r(t,o),i.classList.add(this.options.messages.fieldPrefix+o);for(var u in t){if(!t.hasOwnProperty(u))return;a=a.replace("${"+u+"}",t[u])}n=c.parseFromString(a,"text/html").firstChild.lastChild.firstChild,"bottom"===this.options.messages.fieldPlace?i.appendChild(n):"top"===this.options.messages.fieldPlace?i.insertBefore(n,i.firstChild):(i=i.querySelector(this.options.messages.fieldPlace),i.appendChild(n)),this._messages.push({el:n,close:n.querySelector(this.options.messages.fieldClose),field:i,type:o})}},showFieldsMessages:function(e,t){var o=this,s=sf.iterateInputs(this.node,e,function(e,s){o.showFieldMessage(e,s,t)});s.forEach(function(e){(0,i["default"])(e).forEach(function(s){var r=o.node.querySelector('[data-message-placeholder="'+s+'"]');r&&o.showFieldMessage(r,e[s],t,!0)})})}}},function(e,t,o){e.exports={"default":o(20),__esModule:!0}},function(e,t,o){o(21),e.exports=o(8).Object.keys},function(e,t,o){var s=o(13);o(22)("keys",function(e){return function(t){return e(s(t))}})},function(e,t,o){var s=o(6),r=o(8),n=o(17);e.exports=function(e,t){var o=(r.Object||{})[e]||Object[e],i={};i[e]=t(o),s(s.S+s.F*n(function(){o(1)}),"Object",i)}},function(e,t){"use strict";function o(e,t,r,n){for(var i in t)if(t.hasOwnProperty(i)){var a=n?n+"["+i+"]":i,c=Object.prototype.toString.call(t[i]),u="[name='"+a+"']";switch(c){case"[object Object]":o(e,t[i],r,a);break;case"[object Array]":t[i].forEach(function(t){var o="[name='"+a+"[]'][value='"+t+"']",n=e.querySelectorAll(o);0===n.length&&s.push(o);for(var i=0,c=n.length;c>i;i++)r(n[i],!0)});break;case"[object String]":case"[object Number]":var f=e.querySelectorAll(u);if(0===f.length){var l={};l[a]=t[i],s.push(l)}for(var p=0,m=f.length;m>p;p++)r(f[p],t[i]);break;default:console.error("unknown type -",c," and message",t[i])}}}var s=[],r=function(e,t,r,n){return s=[],o(e,t,r,n),0!==s.length&&console.log("Some element not found in form",s),s};e.exports=r},function(e,t,o){function s(e){return e&&e.__esModule?e:{"default":e}}var r,n=o(25),i=s(n);/*! github.com/serbanghita/formToObject.js 1.0.1  (c) 2013 Serban Ghita <serbanghita@gmail.com> @licence MIT */
!function(){var s=function(e){return e?(this.formRef=e,this.keyRegex=/[^\[\]]+/g,this.$form=null,this.$formElements=[],this.formObj={},this.setForm()&&this.setFormElements()?this.setFormObj():!1):!1};s.prototype.setForm=function(){switch((0,i["default"])(this.formRef)){case"string":this.$form=document.getElementById(this.formRef);break;case"object":this.isDomNode(this.formRef)&&(this.$form=this.formRef)}return this.$form},s.prototype.setFormElements=function(){return this.$formElements=this.$form.querySelectorAll("input, textarea, select"),this.$formElements.length},s.prototype.isDomNode=function(e){return"object"===("undefined"==typeof e?"undefined":(0,i["default"])(e))&&"nodeType"in e&&1===e.nodeType},s.prototype.forEach=function(e,t){if([].forEach)return[].forEach.call(e,t);var o;for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(e,e[o])},s.prototype.addChild=function(e,t,o,s){if(1===o.length){if("INPUT"===t.nodeName&&"radio"===t.type)return t.checked?e[o]=s:void 0;if("INPUT"===t.nodeName&&"checkbox"===t.type)return t.checked?(e[o]||(e[o]=[]),e[o].push(s)):void 0;if("SELECT"===t.nodeName&&"select-multiple"===t.type){e[o]=[];var r=t.querySelectorAll("option[selected]");return void(r&&this.forEach(r,function(t){e[o].push(t.value)}))}e[o]=s}return o.length>1?(e[o[0]]||(e[o[0]]={}),this.addChild(e[o[0]],t,o.splice(1,o.length),s)):e},s.prototype.setFormObj=function(){var e,t=0;for(t=0;t<this.$formElements.length;t++)this.$formElements[t].name&&!this.$formElements[t].disabled&&(e=this.$formElements[t].name.match(this.keyRegex),this.addChild(this.formObj,this.$formElements[t],e,this.$formElements[t].value));return this.formObj},r=function(){return s}.call(t,o,t,e),!(void 0!==r&&(e.exports=r))}()},function(e,t,o){"use strict";var s=o(26)["default"];t["default"]=function(e){return e&&e.constructor===s?"symbol":typeof e},t.__esModule=!0},function(e,t,o){e.exports={"default":o(27),__esModule:!0}},function(e,t,o){o(28),o(46),e.exports=o(8).Symbol},function(e,t,o){"use strict";var s=o(12),r=o(7),n=o(29),i=o(30),a=o(6),c=o(31),u=o(17),f=o(34),l=o(35),p=o(37),m=o(36),h=o(38),d=o(40),g=o(41),v=o(42),y=o(43),b=o(39),_=o(33),x=s.getDesc,w=s.setDesc,O=s.create,S=d.get,M=r.Symbol,F=r.JSON,j=F&&F.stringify,E=!1,k=m("_hidden"),P=s.isEnum,D=f("symbol-registry"),T=f("symbols"),A="function"==typeof M,C=Object.prototype,N=i&&u(function(){return 7!=O(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(e,t,o){var s=x(C,t);s&&delete C[t],w(e,t,o),s&&e!==C&&w(C,t,s)}:w,q=function(e){var t=T[e]=O(M.prototype);return t._k=e,i&&E&&N(C,e,{configurable:!0,set:function(t){n(this,k)&&n(this[k],e)&&(this[k][e]=!1),N(this,e,_(1,t))}}),t},$=function(e){return"symbol"==typeof e},I=function(e,t,o){return o&&n(T,t)?(o.enumerable?(n(e,k)&&e[k][t]&&(e[k][t]=!1),o=O(o,{enumerable:_(0,!1)})):(n(e,k)||w(e,k,_(1,{})),e[k][t]=!0),N(e,t,o)):w(e,t,o)},R=function(e,t){y(e);for(var o,s=g(t=b(t)),r=0,n=s.length;n>r;)I(e,o=s[r++],t[o]);return e},L=function(e,t){return void 0===t?O(e):R(O(e),t)},J=function(e){var t=P.call(this,e);return t||!n(this,e)||!n(T,e)||n(this,k)&&this[k][e]?t:!0},B=function(e,t){var o=x(e=b(e),t);return!o||!n(T,t)||n(e,k)&&e[k][t]||(o.enumerable=!0),o},K=function(e){for(var t,o=S(b(e)),s=[],r=0;o.length>r;)n(T,t=o[r++])||t==k||s.push(t);return s},W=function(e){for(var t,o=S(b(e)),s=[],r=0;o.length>r;)n(T,t=o[r++])&&s.push(T[t]);return s},G=function(e){if(void 0!==e&&!$(e)){for(var t,o,s=[e],r=1,n=arguments;n.length>r;)s.push(n[r++]);return t=s[1],"function"==typeof t&&(o=t),(o||!v(t))&&(t=function(e,t){return o&&(t=o.call(this,e,t)),$(t)?void 0:t}),s[1]=t,j.apply(F,s)}},U=u(function(){var e=M();return"[null]"!=j([e])||"{}"!=j({a:e})||"{}"!=j(Object(e))});A||(M=function(){if($(this))throw TypeError("Symbol is not a constructor");return q(p(arguments.length>0?arguments[0]:void 0))},c(M.prototype,"toString",function(){return this._k}),$=function(e){return e instanceof M},s.create=L,s.isEnum=J,s.getDesc=B,s.setDesc=I,s.setDescs=R,s.getNames=d.get=K,s.getSymbols=W,i&&!o(45)&&c(C,"propertyIsEnumerable",J,!0));var H={"for":function(e){return n(D,e+="")?D[e]:D[e]=M(e)},keyFor:function(e){return h(D,e)},useSetter:function(){E=!0},useSimple:function(){E=!1}};s.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=m(e);H[e]=A?t:q(t)}),E=!0,a(a.G+a.W,{Symbol:M}),a(a.S,"Symbol",H),a(a.S+a.F*!A,"Object",{create:L,defineProperty:I,defineProperties:R,getOwnPropertyDescriptor:B,getOwnPropertyNames:K,getOwnPropertySymbols:W}),F&&a(a.S+a.F*(!A||U),"JSON",{stringify:G}),l(M,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(e,t){var o={}.hasOwnProperty;e.exports=function(e,t){return o.call(e,t)}},function(e,t,o){e.exports=!o(17)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,o){e.exports=o(32)},function(e,t,o){var s=o(12),r=o(33);e.exports=o(30)?function(e,t,o){return s.setDesc(e,t,r(1,o))}:function(e,t,o){return e[t]=o,e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,o){var s=o(7),r="__core-js_shared__",n=s[r]||(s[r]={});e.exports=function(e){return n[e]||(n[e]={})}},function(e,t,o){var s=o(12).setDesc,r=o(29),n=o(36)("toStringTag");e.exports=function(e,t,o){e&&!r(e=o?e:e.prototype,n)&&s(e,n,{configurable:!0,value:t})}},function(e,t,o){var s=o(34)("wks"),r=o(37),n=o(7).Symbol;e.exports=function(e){return s[e]||(s[e]=n&&n[e]||(n||r)("Symbol."+e))}},function(e,t){var o=0,s=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++o+s).toString(36))}},function(e,t,o){var s=o(12),r=o(39);e.exports=function(e,t){for(var o,n=r(e),i=s.getKeys(n),a=i.length,c=0;a>c;)if(n[o=i[c++]]===t)return o}},function(e,t,o){var s=o(15),r=o(14);e.exports=function(e){return s(r(e))}},function(e,t,o){var s=o(39),r=o(12).getNames,n={}.toString,i="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return r(e)}catch(t){return i.slice()}};e.exports.get=function(e){return i&&"[object Window]"==n.call(e)?a(e):r(s(e))}},function(e,t,o){var s=o(12);e.exports=function(e){var t=s.getKeys(e),o=s.getSymbols;if(o)for(var r,n=o(e),i=s.isEnum,a=0;n.length>a;)i.call(e,r=n[a++])&&t.push(r);return t}},function(e,t,o){var s=o(16);e.exports=Array.isArray||function(e){return"Array"==s(e)}},function(e,t,o){var s=o(44);e.exports=function(e){if(!s(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=!0},function(e,t){}])});
//# sourceMappingURL=sf.form.min.js.map